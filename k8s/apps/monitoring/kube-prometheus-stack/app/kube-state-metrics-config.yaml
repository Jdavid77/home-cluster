kube-state-metrics:
  collectors: [ ]
  extraArgs:
    - --custom-resource-state-only=true
  rbac:
    extraRules:
      - apiGroups:
          - gateway.networking.k8s.io
        resources:
          - gateways
          - gatewayclasses
          - httproutes
          - grpcroutes
          - tcproutes
          - tlsroutes
          - udproutes
          - backendtlspolicies
        verbs:
          - list
          - watch
      - apiGroups:
          - source.toolkit.fluxcd.io
          - kustomize.toolkit.fluxcd.io
          - helm.toolkit.fluxcd.io
          - notification.toolkit.fluxcd.io
          - image.toolkit.fluxcd.io
        resources:
          - gitrepositories
          - buckets
          - helmrepositories
          - helmcharts
          - ocirepositories
          - kustomizations
          - helmreleases
          - alerts
          - providers
          - receivers
          - imagerepositories
          - imagepolicies
          - imageupdateautomations
        verbs: [ "list", "watch" ]
  customResourceState:
    enabled: true
    config:
      spec:
        resources:
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "Gateway"
              version: "v1"
            metricNamePrefix: gatewayapi_gateway
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "info"
                help: "Gateway information"
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      gatewayclass_name: [ spec, gatewayClassName ]
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "listener_info"
                help: "Gateway listener information"
                each:
                  type: Info
                  info:
                    path: [ spec, listeners ]
                    labelsFromPath:
                      listener_name: [ "name" ]
                      port: [ "port" ]
                      protocol: [ "protocol" ]
                      hostname: [ "hostname" ]
                      tls_mode: [ "tls","mode" ]
                      allowed_routes_namespaces_from: [ "allowedRoutes", "namespaces", "from" ]
              - name: "status"
                help: "status condition"
                each:
                  type: Gauge
                  gauge:
                    path: [ status, conditions ]
                    labelsFromPath:
                      type: [ "type" ]
                    valueFrom: [ "status" ]
              - name: "status_listener_attached_routes"
                help: "Number of attached routes for a listener"
                each:
                  type: Gauge
                  gauge:
                    path: [ status, listeners ]
                    labelsFromPath:
                      listener_name: [ "name" ]
                    valueFrom: [ "attachedRoutes" ]
              - name: "status_address_info"
                help: "Gateway address types and values"
                each:
                  type: Info
                  info:
                    path: [ status, addresses ]
                    labelsFromPath:
                      type: [ "type" ]
                      value: [ "value" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "GatewayClass"
              version: "v1"
            metricNamePrefix: gatewayapi_gatewayclass
            labelsFromPath:
              name:
                - metadata
                - name
            metrics:
              - name: "info"
                help: "GatewayClass information"
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      controller_name: [ spec, controllerName ]
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "status"
                help: "status condition"
                each:
                  type: Gauge
                  gauge:
                    path: [ status, conditions ]
                    labelsFromPath:
                      type: [ "type" ]
                    valueFrom: [ "status" ]
              - name: "status_supported_features"
                help: "List of supported features for the GatewayClass"
                each:
                  type: Info
                  info:
                    path: [ status, supportedFeatures ]
                    labelsFromPath:
                      features: [ ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "HTTPRoute"
              version: "v1"
            metricNamePrefix: gatewayapi_httproute
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "hostname_info"
                help: "Hostname information"
                each:
                  type: Info
                  info:
                    path: [ spec, hostnames ]
                    labelsFromPath:
                      hostname: [ ]
              - name: "parent_info"
                help: "Parent references that the httproute wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, parentRefs ]
                    labelsFromPath:
                      parent_group: [ "group" ]
                      parent_kind: [ "kind" ]
                      parent_name: [ "name" ]
                      parent_namespace: [ "namespace" ]
                      parent_section_name: [ "sectionName" ]
                      parent_port: [ "port" ]
              - name: "status_parent_info"
                help: "Parent references that the httproute is attached to"
                each:
                  type: Info
                  info:
                    path: [ status, parents ]
                    labelsFromPath:
                      controller_name: [ "controllerName" ]
                      parent_group: [ "parentRef", "group" ]
                      parent_kind: [ "parentRef", "kind" ]
                      parent_name: [ "parentRef", "name" ]
                      parent_namespace: [ "parentRef", "namespace" ]
                      parent_section_name: [ "parentRef", "sectionName" ]
                      parent_port: [ "parentRef", "port" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "GRPCRoute"
              version: "v1"
            metricNamePrefix: gatewayapi_grpcroute
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "hostname_info"
                help: "Hostname information"
                each:
                  type: Info
                  info:
                    path: [ spec, hostnames ]
                    labelsFromPath:
                      hostname: [ ]
              - name: "parent_info"
                help: "Parent references that the grpcroute wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, parentRefs ]
                    labelsFromPath:
                      parent_group: [ "group" ]
                      parent_kind: [ "kind" ]
                      parent_name: [ "name" ]
                      parent_namespace: [ "namespace" ]
                      parent_section_name: [ "sectionName" ]
                      parent_port: [ "port" ]
              - name: "status_parent_info"
                help: "Parent references that the grpcroute is attached to"
                each:
                  type: Info
                  info:
                    path: [ status, parents ]
                    labelsFromPath:
                      controller_name: [ "controllerName" ]
                      parent_group: [ "parentRef", "group" ]
                      parent_kind: [ "parentRef", "kind" ]
                      parent_name: [ "parentRef", "name" ]
                      parent_namespace: [ "parentRef", "namespace" ]
                      parent_section_name: [ "parentRef", "sectionName" ]
                      parent_port: [ "parentRef", "port" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "TCPRoute"
              version: "v1alpha2"
            metricNamePrefix: gatewayapi_tcproute
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "parent_info"
                help: "Parent references that the tcproute wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, parentRefs ]
                    labelsFromPath:
                      parent_group: [ "group" ]
                      parent_kind: [ "kind" ]
                      parent_name: [ "name" ]
                      parent_namespace: [ "namespace" ]
                      parent_section_name: [ "sectionName" ]
                      parent_port: [ "port" ]
              - name: "status_parent_info"
                help: "Parent references that the tcproute is attached to"
                each:
                  type: Info
                  info:
                    path: [ status, parents ]
                    labelsFromPath:
                      controller_name: [ "controllerName" ]
                      parent_group: [ "parentRef", "group" ]
                      parent_kind: [ "parentRef", "kind" ]
                      parent_name: [ "parentRef", "name" ]
                      parent_namespace: [ "parentRef", "namespace" ]
                      parent_section_name: [ "parentRef", "sectionName" ]
                      parent_port: [ "parentRef", "port" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "TLSRoute"
              version: "v1alpha2"
            metricNamePrefix: gatewayapi_tlsroute
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "hostname_info"
                help: "Hostname information"
                each:
                  type: Info
                  info:
                    path: [ spec, hostnames ]
                    labelsFromPath:
                      hostname: [ ]
              - name: "parent_info"
                help: "Parent references that the tlsroute wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, parentRefs ]
                    labelsFromPath:
                      parent_group: [ "group" ]
                      parent_kind: [ "kind" ]
                      parent_name: [ "name" ]
                      parent_namespace: [ "namespace" ]
                      parent_section_name: [ "sectionName" ]
                      parent_port: [ "port" ]
              - name: "status_parent_info"
                help: "Parent references that the tlsroute is attached to"
                each:
                  type: Info
                  info:
                    path: [ status, parents ]
                    labelsFromPath:
                      controller_name: [ "controllerName" ]
                      parent_group: [ "parentRef", "group" ]
                      parent_kind: [ "parentRef", "kind" ]
                      parent_name: [ "parentRef", "name" ]
                      parent_namespace: [ "parentRef", "namespace" ]
                      parent_section_name: [ "parentRef", "sectionName" ]
                      parent_port: [ "parentRef", "port" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "UDPRoute"
              version: "v1alpha2"
            metricNamePrefix: gatewayapi_udproute
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "parent_info"
                help: "Parent references that the udproute wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, parentRefs ]
                    labelsFromPath:
                      parent_group: [ "group" ]
                      parent_kind: [ "kind" ]
                      parent_name: [ "name" ]
                      parent_namespace: [ "namespace" ]
                      parent_section_name: [ "sectionName" ]
                      parent_port: [ "port" ]
              - name: "status_parent_info"
                help: "Parent references that the udproute is attached to"
                each:
                  type: Info
                  info:
                    path: [ status, parents ]
                    labelsFromPath:
                      controller_name: [ "controllerName" ]
                      parent_group: [ "parentRef", "group" ]
                      parent_kind: [ "parentRef", "kind" ]
                      parent_name: [ "parentRef", "name" ]
                      parent_namespace: [ "parentRef", "namespace" ]
                      parent_section_name: [ "parentRef", "sectionName" ]
                      parent_port: [ "parentRef", "port" ]
          - groupVersionKind:
              group: gateway.networking.k8s.io
              kind: "BackendTLSPolicy"
              version: "v1alpha3"
            metricNamePrefix: gatewayapi_backendtlspolicy
            labelsFromPath:
              name:
                - metadata
                - name
              namespace:
                - metadata
                - namespace
            metrics:
              - name: "labels"
                help: "Kubernetes labels converted to Prometheus labels."
                each:
                  type: Info
                  info:
                    path: [ metadata ]
                    labelsFromPath:
                      "*": [ labels ]
              - name: "created"
                help: "created timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, creationTimestamp ]
              - name: "deleted"
                help: "deletion timestamp"
                each:
                  type: Gauge
                  gauge:
                    path: [ metadata, deletionTimestamp ]
              - name: "target_info"
                help: "Target references that the backendtlspolicy wants to be attached to"
                each:
                  type: Info
                  info:
                    path: [ spec, targetRef ]
                    labelsFromPath:
                      target_group: [ "group" ]
                      target_kind: [ "kind" ]
                      target_name: [ "name" ]
                      target_namespace: [ "namespace" ]
          - groupVersionKind:
              group: kustomize.toolkit.fluxcd.io
              version: v1
              kind: Kustomization
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux Kustomization resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, lastAppliedRevision ]
                  source_name: [ spec, sourceRef, name ]
          - groupVersionKind:
              group: helm.toolkit.fluxcd.io
              version: v2
              kind: HelmRelease
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux HelmRelease resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, history, "0", chartVersion ]
                  chart_name: [ status, history, "0", chartName ]
                  chart_app_version: [ status, history, "0", appVersion ]
                  chart_ref_name: [ spec, chartRef, name ]
                  chart_source_name: [ spec, chart, spec, sourceRef, name ]
          - groupVersionKind:
              group: source.toolkit.fluxcd.io
              version: v1
              kind: GitRepository
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux GitRepository resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, artifact, revision ]
                  url: [ spec, url ]
          - groupVersionKind:
              group: source.toolkit.fluxcd.io
              version: v1
              kind: Bucket
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux Bucket resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, artifact, revision ]
                  endpoint: [ spec, endpoint ]
                  bucket_name: [ spec, bucketName ]
          - groupVersionKind:
              group: source.toolkit.fluxcd.io
              version: v1
              kind: HelmRepository
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux HelmRepository resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, artifact, revision ]
                  url: [ spec, url ]
          - groupVersionKind:
              group: source.toolkit.fluxcd.io
              version: v1
              kind: HelmChart
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux HelmChart resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, artifact, revision ]
                  chart_name: [ spec, chart ]
                  chart_version: [ spec, version ]
          - groupVersionKind:
              group: source.toolkit.fluxcd.io
              version: v1
              kind: OCIRepository
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux OCIRepository resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  revision: [ status, artifact, revision ]
                  url: [ spec, url ]
          - groupVersionKind:
              group: notification.toolkit.fluxcd.io
              version: v1beta3
              kind: Alert
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux Alert resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  suspended: [ spec, suspend ]
          - groupVersionKind:
              group: notification.toolkit.fluxcd.io
              version: v1beta3
              kind: Provider
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux Provider resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  suspended: [ spec, suspend ]
          - groupVersionKind:
              group: notification.toolkit.fluxcd.io
              version: v1
              kind: Receiver
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux Receiver resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  webhook_path: [ status, webhookPath ]
          - groupVersionKind:
              group: image.toolkit.fluxcd.io
              version: v1
              kind: ImageRepository
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux ImageRepository resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  image: [ spec, image ]
          - groupVersionKind:
              group: image.toolkit.fluxcd.io
              version: v1
              kind: ImagePolicy
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux ImagePolicy resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  source_name: [ spec, imageRepositoryRef, name ]
          - groupVersionKind:
              group: image.toolkit.fluxcd.io
              version: v1
              kind: ImageUpdateAutomation
            metricNamePrefix: gotk
            metrics:
              - name: "resource_info"
                help: "The current state of a Flux ImageUpdateAutomation resource."
                each:
                  type: Info
                  info:
                    labelsFromPath:
                      name: [ metadata, name ]
                labelsFromPath:
                  exported_namespace: [ metadata, namespace ]
                  ready: [ status, conditions, "[type=Ready]", status ]
                  suspended: [ spec, suspend ]
                  source_name: [ spec, sourceRef, name ]