apiVersion: db.movetokube.com/v1alpha1
kind: Postgres
metadata:
  name: mattermost-db
spec:
  database: mattermost
  dropOnDelete: false
---
apiVersion: db.movetokube.com/v1alpha1
kind: PostgresUser
metadata:
  name: mattermost-user
spec:
  role: mattermost
  database: mattermost-db
  secretName: mattermost-db-secret
  privileges: OWNER
  secretTemplate:
    DB_CONNECTION_CHECK_URL: postgres://{{.Role}}:{{.Password}}@{{.Host}}:5432/{{.Database}}?sslmode=disable
    DB_CONNECTION_STRING: postgres://{{.Role}}:{{.Password}}@{{.Host}}:5432/{{.Database}}?sslmode=disable
    MM_SQLSETTINGS_DATASOURCEREPLICAS: postgres://{{.Role}}:{{.Password}}@{{.Host}}:5432/{{.Database}}?sslmode=disable
