apiVersion: installation.mattermost.com/v1beta1
kind: Mattermost
metadata:
  name: mattermost
spec:
  replicas: 1
  imagePullPolicy: IfNotPresent
  version: 5.28.0
  size: 10users
  useServiceLoadBalancer: false
  ingress:
    enabled: false
  database:
    external:
      secret: mattermost-db-secret
  fileStore:
    external:
      url: minio.storage.svc.cluster.local:9000
      bucket: mattermost
      secret: mattermost-s3
  podExtensions:
    initContainers:
      - name: init-db
        image: ghcr.io/home-operations/postgres-init:17.5
        imagePullPolicy: IfNotPresent
        envFrom:
          - secretRef:
              name: mattermost-db-secret
